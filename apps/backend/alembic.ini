# =================================================================
# ECO IGLESIA LETRAS API - CONFIGURACIÓN ALEMBIC
# =================================================================
# Configuración de migraciones de base de datos para Alembic
# Actualizado para integración profesional con el sistema
# =================================================================

[alembic]
# Ubicación de los scripts de migración
script_location = %(here)s/alembic

# Plantilla para nombres de archivos de migración con fecha y hora
# Formato: YYYY_MM_DD_HHMM-revision_slug
file_template = %%(year)d_%%(month).2d_%%(day).2d_%%(hour).2d%%(minute).2d-%%(rev)s_%%(slug)s

# Agregar directorio actual al path de Python
prepend_sys_path = .

# Longitud máxima para el slug del archivo
truncate_slug_length = 50

# Ejecutar entorno durante comando 'revision' con autogenerate
revision_environment = true

# Permitir archivos .pyc/.pyo sin .py fuente
sourceless = false

# Buscar archivos de versión recursivamente
recursive_version_locations = false

# Codificación de salida para archivos de migración
output_encoding = utf-8

# version location specification; This defaults
# to <script_location>/versions.  When using multiple version
# directories, initial revisions must be specified with --version-path.
# The path separator used here should be the separator specified by "path_separator"
# below.
# version_locations = %(here)s/bar:%(here)s/bat:%(here)s/alembic/versions

# path_separator; This indicates what character is used to split lists of file
# paths, including version_locations and prepend_sys_path within configparser
# files such as alembic.ini.
# The default rendered in new alembic.ini files is "os", which uses os.pathsep
# to provide os-dependent path splitting.
#
# Note that in order to support legacy alembic.ini files, this default does NOT
# take place if path_separator is not present in alembic.ini.  If this
# option is omitted entirely, fallback logic is as follows:
#
# 1. Parsing of the version_locations option falls back to using the legacy
#    "version_path_separator" key, which if absent then falls back to the legacy
#    behavior of splitting on spaces and/or commas.
# 2. Parsing of the prepend_sys_path option falls back to the legacy
#    behavior of splitting on spaces, commas, or colons.
#
# Valid values for path_separator are:
#
# path_separator = :
# path_separator = ;
# path_separator = space
# path_separator = newline
#
# Uso de os.pathsep para separación de rutas multi-plataforma
path_separator = os

# =================================================================
# CONFIGURACIÓN DE BASE DE DATOS
# =================================================================
# URL de base de datos - usa variables de entorno del sistema
# Esta URL será sobrescrita por env.py usando las configuraciones del .env
sqlalchemy.url = driver://user:pass@localhost/dbname


# =================================================================
# HOOKS POST-ESCRITURA
# =================================================================
[post_write_hooks]
# Formatear código con black después de generar migraciones
hooks = black
black.type = console_scripts
black.entrypoint = black
black.options = -l 88 --target-version py311 REVISION_SCRIPT_FILENAME

# =================================================================
# CONFIGURACIÓN DE LOGGING
# =================================================================
[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console,file

[formatters]
keys = generic,detailed

[logger_root]
level = INFO
handlers = console
qualname =

[logger_sqlalchemy]
level = INFO
handlers = console,file
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers = console,file
qualname = alembic

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[handler_file]
class = FileHandler
args = ('alembic.log', 'a')
level = DEBUG
formatter = detailed

[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S

[formatter_detailed]
format = %(asctime)s - %(name)s - %(levelname)s - %(message)s
datefmt = %Y-%m-%d %H:%M:%S
